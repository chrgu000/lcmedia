/*
 * xhEditor - WYSIWYG XHTML Editor
 * @requires jQuery v1.3.2(fixed)
 * 
 * @author Yanis.Wang<yanis.wang@gmail.com>
 * @site http://pirate9.com/
 * @licence LGPL(http://www.opensource.org/licenses/lgpl-license.php)
 * 
 * @Version: 0.9.4 build 090502
 */
(function(h){h.fn.xheditor=function(D,E){return this.each(function(){if(this.tagName.toLowerCase()!="textarea"){return}if(D){if(!this.xheditor){var F=new h.xheditor(this,E);if(F.init()){this.xheditor=F}else{F=null}}}else{if(this.xheditor){this.xheditor.remove();this.xheditor=null}}})};var j=0,p=h.browser.msie,k=h.browser.mozilla,A=h.browser.safari,q=false;var d,n,i;var z,x;z=window.location.href.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]*$/,"");z+="/";var B=h("script[src$=xheditor.js]");if(B.size()==1){x=B[0].src.replace(/[\?#].*$/,"").replace(/(^|[\/\\])[^\/]*$/,"");if(x!=""){x+="/"}}var y={27:"esc",9:"tab",32:"space",13:"return",8:"backspace",145:"scroll",20:"capslock",144:"numlock",19:"pause",45:"insert",36:"home",46:"del",35:"end",33:"pageup",34:"pagedown",37:"left",38:"up",39:"right",40:"down",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12"};var l=["#FFFFFF","#E5E4E4","#D9D8D8","#C0BDBD","#A7A4A4","#8E8A8B","#827E7F","#767173","#5C585A","#000000","#FEFCDF","#FEF4C4","#FEED9B","#FEE573","#FFED43","#F6CC0B","#E0B800","#C9A601","#AD8E00","#8C7301","#FFDED3","#FFC4B0","#FF9D7D","#FF7A4E","#FF6600","#E95D00","#D15502","#BA4B01","#A44201","#8D3901","#FFD2D0","#FFBAB7","#FE9A95","#FF7A73","#FF483F","#FE2419","#F10B00","#D40A00","#940000","#6D201B","#FFDAED","#FFB7DC","#FFA1D1","#FF84C3","#FF57AC","#FD1289","#EC0078","#D6006D","#BB005F","#9B014F","#FCD6FE","#FBBCFF","#F9A1FE","#F784FE","#F564FE","#F546FF","#F328FF","#D801E5","#C001CB","#8F0197","#E2F0FE","#C7E2FE","#ADD5FE","#92C7FE","#6EB5FF","#48A2FF","#2690FE","#0162F4","#013ADD","#0021B0","#D3FDFF","#ACFAFD","#7CFAFF","#4AF7FE","#1DE6FE","#01DEFF","#00CDEC","#01B6DE","#00A0C2","#0084A0","#EDFFCF","#DFFEAA","#D1FD88","#BEFA5A","#A8F32A","#8FD80A","#79C101","#3FA701","#307F00","#156200","#D4C89F","#DAAD88","#C49578","#C2877E","#AC8295","#C0A5C4","#969AC2","#92B7D7","#80ADAF","#9CA53B"];var w=[{n:"p",t:"普通段落"},{n:"h1",t:"标题1"},{n:"h2",t:"标题2"},{n:"h3",t:"标题3"},{n:"h4",t:"标题4"},{n:"h5",t:"标题5"},{n:"h6",t:"标题6"},{n:"pre",t:"已编排格式"},{n:"address",t:"地址"}];var c=["宋体","黑体","楷体","隶书","幼圆","Arial","Arial Narrow","Arial Black","Comic Sans MS","Courier","System","Times New Roman","Verdana"];var t=[{n:"xx-small",wkn:"x-small",s:"8pt",t:"极小"},{n:"x-small",wkn:"small",s:"10pt",t:"特小"},{n:"small",wkn:"medium",s:"12pt",t:"小"},{n:"medium",wkn:"large",s:"14pt",t:"中"},{n:"large",wkn:"x-large",s:"18pt",t:"大"},{n:"x-large",wkn:"xx-large",s:"24pt",t:"特大"},{n:"xx-large",wkn:"-webkit-xxx-large",s:"36pt",t:"极大"}];var e=[{s:"左对齐",v:"justifyleft",t:"左对齐"},{s:"居中",v:"justifycenter",t:"居中"},{s:"右对齐",v:"justifyright",t:"右对齐"},{s:"两端对齐",v:"justifyfull",t:"两端对齐"}],f=[{s:"数字列表",v:"insertOrderedList",t:"数字列表"},{s:"符号列表",v:"insertUnorderedList",t:"符号列表"}];var a='<div>使用键盘快捷键(Ctrl+V)把内容粘贴到方框里，按 确定</div><div><textarea id="xhEdtPastetextValue" wrap="soft" spellcheck="false" style="width:300px;height:100px;" /></div><div style="text-align:right;"><input type="button" id="xhEdtSave" value="确定" /></div>';var b='<div>链接地址: <input type="text" id="xhEdtLinkHref" value="http://" /></div><div>打开方式: <select id="xhEdtLinkTarget"><option selected="selected" value="">默认</option><option value="_blank">新窗口</option><option value="_self">当前窗口</option><option value="_parent">父窗口</option></select></div><div style="text-align:right;"><input type="button" id="xhEdtSave" value="确定" /></div>';var v='<div>图片地址：<input type="text" id="xhEdtImgSrc" value="http://" /></div><div>替换文本：<input type="text" id="xhEdtImgAlt" /></div><div>对齐方式：<select id="xhEdtImgAlign"><option selected="selected" value="">默认</option><option value="left">左对齐</option><option value="right">右对齐</option><option value="top">顶端</option><option value="middle">居中</option><option value="baseline">基线</option><option value="bottom">底边</option></select></div><div>宽度高度：<input type="text" id="xhEdtImgWidth" style="width:40px;" /> x <input type="text" id="xhEdtImgHeight" style="width:40px;" /></div><div>边框大小：<input type="text" id="xhEdtImgBorder" style="width:40px;" /></div><div>水平间距：<input type="text" id="xhEdtImgVspace" style="width:40px;" /> 垂直间距：<input type="text" id="xhEdtImgHspace" style="width:40px;" /></div><div style="text-align:right;"><input type="button" id="xhEdtSave" value="确定" /></div>';var C='<div>动画地址：<input type="text" id="xhEdtFlashSrc" value="http://" /></div><div>宽度高度：<input type="text" id="xhEdtFlashWidth" style="width:40px;" value="412" /> x <input type="text" id="xhEdtFlashHeight" style="width:40px;" value="300" /></div><div style="text-align:right;"><input type="button" id="xhEdtSave" value="确定" /></div>';var u='<div>视频地址：<input type="text" id="xhEdtMediaSrc" value="http://" /></div><div>宽度高度：<input type="text" id="xhEdtMediaWidth" style="width:40px;" value="412" /> x <input type="text" id="xhEdtMediaHeight" style="width:40px;" value="300" /></div><div style="text-align:right;"><input type="button" id="xhEdtSave" value="确定" /></div>';var g='<div>行数列数：<input type="text" id="xhEdtTableRows" style="width:40px;" value="3" /> x <input type="text" id="xhEdtTableColumns" style="width:40px;" value="2" /></div><div>标题单元：<select id="xhEdtTableHeaders"><option selected="selected" value="">无</option><option value="row">第一行</option><option value="col">第一列</option><option value="both">第一行和第一列</option></select></div><div>宽度高度：<input type="text" id="xhEdtTableWidth" style="width:40px;" value="200" /> x <input type="text" id="xhEdtTableHeight" style="width:40px;" value="" /></div><div>边框大小：<input type="text" id="xhEdtTableBorder" style="width:40px;" value="1" /></div><div>间距边距：<input type="text" id="xhEdtTableCellSpacing" style="width:40px;" value="1" /> <input type="text" id="xhEdtTableCellPadding" style="width:40px;" value="1" /></div><div>对齐方式：<select id="xhEdtTableAlign"><option selected="selected" value="">默认</option><option value="left">左对齐</option><option value="center">居中</option><option value="right">右对齐</option></select></div><div>表格标题：<input type="text" id="xhEdtTableCaption" /></div><div style="text-align:right;"><input type="button" id="xhEdtSave" value="确定" /></div>';var o='<div style="width:200px;word-wrap:break-word;word-break:break-all;"><p><span style="font-size:20px;color:#1997DF;">xhEditor</span><br />版本：v0.9.4 build 20090502</p><p>xhEditor是一个基于jQuery开发的跨平台开源XHTML编辑器组件。</p><p><a href="http://xheditor.googlecode.com/" target="_blank">http://xheditor.googlecode.com/</a></p></div><div style="text-align:right;"><input type="button" id="xhEdtSave" value="确定" /></div>';var m=[{t:"Big grin",s:"biggrin.gif"},{t:"Smile",s:"smile.gif"},{t:"Titter",s:"titter.gif"},{t:"Lol",s:"lol.gif"},{t:"Call",s:"call.gif"},{t:"Victory",s:"victory.gif"},{t:"Shy",s:"shy.gif"},{t:"Handshake",s:"handshake.gif"},{t:"Kiss",s:"kiss.gif"},{t:"Sad",s:"sad.gif"},{t:"Cry",s:"cry.gif"},{t:"Huffy",s:"huffy.gif"},{t:"Mad",s:"mad.gif"},{t:"Tongue",s:"tongue.gif"},{t:"Sweat",s:"sweat.gif"},{t:"Shocked",s:"shocked.gif"},{t:"Time",s:"time.gif"},{t:"Hug",s:"hug.gif"}];var s={GStart:{},GEnd:{},Separator:{},Cut:{t:"剪切 (Ctrl+X)"},Copy:{t:"复制 (Ctrl+C)"},Paste:{t:"粘贴 (Ctrl+V)"},Pastetext:{t:"粘贴文本"},Blocktag:{t:"段落标签"},Fontface:{t:"字体"},FontSize:{t:"字号"},Bold:{t:"加粗 (Ctrl+B)",s:"Ctrl+B"},Italic:{t:"斜体 (Ctrl+I)",s:"Ctrl+I"},Underline:{t:"下划线 (Ctrl+U)",s:"Ctrl+U"},Strikethrough:{t:"中划线 (Ctrl+S)",s:"Ctrl+S"},FontColor:{t:"字体颜色"},BackColor:{t:"背景颜色"},Removeformat:{t:"删除文字格式"},Align:{t:"对齐"},List:{t:"列表"},Outdent:{t:"减少缩进"},Indent:{t:"增加缩进"},Link:{t:"超链接"},Unlink:{t:"取消超链接"},Img:{t:"图片"},Flash:{t:"Flash动画"},Media:{t:"视频"},Emot:{t:"表情"},Table:{t:"表格"},Source:{t:"源代码"},Preview:{t:"预览"},Fullscreen:{t:"全屏编辑 (Esc)",s:"Esc"},About:{t:"关于 xhEditor"}};var r={mini:"GStart,Bold,Italic,Underline,Strikethrough,GEnd,Separator,GStart,Align,List,GEnd,Separator,GStart,Link,Img,About,GEnd",simple:"GStart,Blocktag,Fontface,FontSize,Bold,Italic,Underline,Strikethrough,FontColor,BackColor,GEnd,Separator,GStart,Align,List,Outdent,Indent,GEnd,Separator,GStart,Link,Img,Source,About,GEnd",full:"GStart,Cut,Copy,Paste,Pastetext,GEnd,Separator,GStart,Blocktag,Fontface,FontSize,Bold,Italic,Underline,Strikethrough,FontColor,BackColor,Removeformat,GEnd,Separator,GStart,Align,List,Outdent,Indent,GEnd,Separator,GStart,Link,Unlink,Img,Flash,Media,Emot,Table,GEnd,Separator,GStart,Source,Preview,Fullscreen,About,GEnd",ubb:"GStart,Cut,Copy,Paste,Pastetext,GEnd,Separator,GStart,Blocktag,Fontface,FontSize,Bold,Italic,Underline,FontColor,Removeformat,GEnd,Separator,GStart,Align,List,Outdent,Indent,GEnd,Separator,GStart,Link,Unlink,Img,Flash,Media,Emot,Table,GEnd,Separator,GStart,Source,Preview,Fullscreen,About,GEnd"};h.xheditor=function(R,H){var O={skin:"default",tools:"full",clearScript:true,clearStyle:true,showBlocktag:false,forcePtag:true};var W=this,F=R,X=h(F),L=X.closest("form"),P,N,ad,G,U;var M;var Q=false,K=false,E=false,ac=false,T="",ab;var aa=h.extend({},O,H);if(aa.tools.match(/^\s*(mini|simple|full|ubb)\s*$/i)){aa.tools=h.trim(aa.tools);aa.tools=r[aa.tools]}if(!aa.tools.match(/(^|,)\s*About\s*(,|$)/i)){aa.tools+=",About"}aa.tools=aa.tools.split(",");var J="xhEdtCSS_"+aa.skin,V="xhEdt"+j+"_container",D="xhEdt"+j+"_Tool",S="xhEdt"+j+"_iframearea",Z="xhEdt"+j+"_iframe";var Y="";if(aa.showBlocktag){Y+=" showBlocktag"}var I=[];this.init=function(){if(h("#"+J).size()==0){h("head").append('<link id="'+J+'" rel="stylesheet" type="text/css" href="'+x+"xheditor_skin/"+aa.skin+'/ui.css" />')}var ae=aa.width||F.style.width||F.offsetWidth,ah=aa.height||F.style.height||F.offsetHeight;var ag=/^[0-9\.]+(|px)$/i;if(ag.test(""+ae)){ae+="px"}var aj=24;X.after(h('<span id="'+V+'" class="xhEdt_'+aa.skin+'" style="display:none"><table cellspacing="0" cellpadding="0" class="xhEdtLayout" style="width:'+ae+";height:"+ah+'px;"><tbody><tr><td id="'+D+'" class="xhEdtTool" style="height:'+aj+'px"></td></tr><tr><td id="'+S+'"class="xhEdtIframeArea"><iframe frameborder="0" id="'+Z+'" src="javascript:;" style="width:100%" /></td></tr></tbody></table></span>'));N=h("#"+Z)[0].contentWindow;ad=h(N);try{G=N.document;U=h(G);G.open();G.write('<html><head><base href="'+z+'"/><meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/><link rel="stylesheet" href="'+x+"xheditor_skin/"+aa.skin+'/iframe.css"/>');if(aa.loadCSS){G.write('<link rel="stylesheet" href="'+aa.loadCSS+'"/>')}G.write('</head><body dir="ltr" spellcheck="false" class="editMode'+Y+'"></body></html>');G.close();if(p){G.body.contentEditable="true"}else{G.designMode="On"}}catch(ak){}setTimeout(W.setOpts,300);W.setSource();N.setInterval=null;var ai="",af;ai+='<table cellspacing="0" cellpadding="0"><tbody><tr>';h.each(aa.tools,function(al,am){af=s[am];if(am=="GStart"){ai+='<td><span class="xhEdtGStart"/></td>'}else{if(am=="GEnd"){ai+='<td><span class="xhEdtGEnd"/></td>'}else{if(am=="Separator"){ai+='<td><span class="xhEdtSeparator"/></td>'}else{ai+='<td><a href="javascript:;" title="'+af.t+'" name="'+am+'" class="xhEdtButton xhEdtEnabled"><span class="xhEdtIcon xhEdtBtn'+am+'"/></a></td>';if(af.s){W.addShortCut(af.s,am)}}}}});ai+="</tr></tbody></table>";P=h("#"+D).append(ai).click(function(){W.focus()});P.find(".xhEdtButton").click(function(am){W.hidePanel();W.focus();ab=am;var al=h(this);if(al.is(".xhEdtEnabled")){W.exec(al.attr("name"))}ab.stopPropagation()}).mousedown(function(){return false});d=h("#xhEdtPanel");n=h("#xhEdtCntLine");if(d.size()==0){d=h('<div id="xhEdtPanel"></div>').mousedown(function(al){al.stopPropagation()});n=h('<div id="xhEdtCntLine"><img src="'+x+"xheditor_skin/"+aa.skin+'/img/spacer.gif" /></div>');h(document.body).append(d).append(n)}h(document).mousedown(W.hidePanel);U.mousedown(W.hidePanel);if(p){U.bind("beforedeactivate",function(){if(!K){M=W.getRng()}});ad.focus(function(){if(M&&!K){M.select();M=null}})}h("#"+V).show();X.hide();W.bind();j++;Q=true;if(aa.fullscreen){W.toggleFullscreen()}return true};this.remove=function(){W.unbind();h("#"+V).remove();X.show();Q=false};this.bind=function(){ad.blur(W.getSource);if(A){ad.click(W.fixAppleSel)}L.submit(W.getSource).bind("reset",W.setSource);var ae=h(window);ae.unload(W.getSource).bind("beforeunload",W.getSource);ae.resize(W.fixFullHeight);U.keydown(W.checkShortCut).keydown(W.forcePtag)};this.unbind=function(){ad.unbind("blur",W.getSource);if(A){ad.unbind("click",W.fixAppleSel)}L.unbind("submit",W.getSource).unbind("reset",W.setSource);var ae=h(window);ae.unbind("unload",W.getSource).unbind("beforeunload",W.getSource);ae.unbind("resize",W.fixFullHeight);U.unbind("keydown",W.checkShortCut).unbind("keydown",W.forcePtag)};this.setCSS=function(ae){try{W._exec("styleWithCSS",ae)}catch(af){try{W._exec("useCSS",!ae)}catch(af){}}};this.setOpts=function(){if(Q&&!E&&!K){W.setCSS(false);try{W._exec("enableObjectResizing",true)}catch(ae){}try{W._exec("enableInlineTableEditing",false)}catch(ae){}if(p){try{W._exec("BackgroundImageCache",true)}catch(ae){}}}};this.forcePtag=function(ag){if(K||E){return}if(ag.keyCode==13&&!ag.shiftKey){var af=W.getParent("p,h1,h2,h3,h4,h5,h6,pre,address,div,li");if(aa.forcePtag){if(af.size()==0){W._exec("formatblock","<p>")}}else{if(!p){return}if(af.size()==0){var ae=W.getRng();ae.text="\n";ae.select();return false}}}};this.fixFullHeight=function(){if(!k&&!A){var ae=h("#"+S);ae.height("100%");if(ac){ae.height((ae.height()-30)+"px")}if(p){P.hide().show()}}};this.fixAppleSel=function(ag){ag=ag.target;if(ag.tagName.match(/(img|embed)/i)){var af=W.getSel(),ae=G.createRange();ae.selectNode(ag);af.removeAllRanges();af.addRange(ae)}};this.focus=function(){if(!K){ad.focus()}else{h("#sourceCode",G).focus()}};this.getSel=function(){return N.getSelection?N.getSelection():G.selection};this.getRng=function(){var ag=W.getSel(),ae;try{ae=ag.rangeCount>0?ag.getRangeAt(0):(ag.createRange?ag.createRange():G.createRange())}catch(af){}if(!ae){ae=p?G.body.createTextRange():G.createRange()}return ae};this.getParent=function(ae){var af=W.getRng(),ag;if(!p){ag=af.commonAncestorContainer;if(!af.collapsed){if(af.startContainer==af.endContainer&&af.startOffset-af.endOffset<2&&af.startContainer.hasChildNodes()){ag=af.startContainer.childNodes[af.startOffset]}}}else{ag=af.item?af.item(0):af.parentElement()}ae=ae?ae:"*";ag=h(ag);if(!ag.is(ae)){ag=h(ag).closest(ae)}return ag};this.pasteHTML=function(af){if(K||E){return false}W.focus();var ae=W.getRng();if(ae.insertNode){ae.deleteContents();ae.insertNode(ae.createContextualFragment(af))}else{if(ae.item){W._exec("delete");ae=W.getRng()}ae.pasteHTML(af)}};this.pasteText=function(ae){if(!ae){ae=""}ae=W.domEncode(ae);ae=ae.replace(/\r?\n/g,"<br />");W.pasteHTML(ae)};this.domEncode=function(af){if(af){var ae={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"};af=af.replace(/[&"<>]/g,function(ag){return ae[ag]})}return af};this.setSource=function(ae){setTimeout(function(){W._setSource(ae)},10)};this._setSource=function(ae){M=null;if(typeof ae!="string"&&ae!=""){ae=X.val()}if(!K&&aa.beforeSetSource){ae=aa.beforeSetSource(ae)}ae=W.formatXHTML(ae);if(K){h("#sourceCode",G).val(ae)}else{h(G.body)[0].innerHTML=W.processHTML(ae,"write")}};this.processHTML=function(aj,ai){var af=' class="Apple-style-span"';if(ai=="write"){if(k){aj=aj.replace(/<(\/?)strong( [^>]+)?>/ig,"<$1b$2>");aj=aj.replace(/<(\/?)em( [^>]+)?>/ig,"<$1i$2>")}else{if(A){aj=aj.replace(/("|;)\s*font-size\s*:\s*([a-z-]+);/ig,function(ao,ap,ak){var am,an;for(var al=0;al<t.length;al++){am=t[al];if(ak==am.n){an=am.wkn;break}}return ap+"font-size:"+an});aj=aj.replace(/<(\/?)strong( [^>]+)?>/ig,"<$1span"+af+' style="font-weight: bold;"$2>');aj=aj.replace(/<(\/?)em( [^>]+)?>/ig,"<$1span"+af+' style="font-style: italic;"$2>');aj=aj.replace(/<(\/?)u( [^>]+)?>/ig,"<$1span"+af+' style="text-decoration: underline;"$2>');aj=aj.replace(/<(\/?)strike( [^>]+)?>/ig,"<$1span"+af+' style="text-decoration: line-through;"$2>');aj=aj.replace(/<span((?:\s+[^>]+)?\s+style="([^"]*;)*\s*(font-family|font-size|color|background-color)\s*:\s*[^;"]+\s*;?"[^>]*)>/ig,"<span"+af+"$1>")}else{if(p){aj=aj.replace(/&apos;/ig,"&#39;");aj=aj.replace(/\s+(disabled|checked|readonly|selected)\s*=\s*[\"\']?(false|0)[\"\']?/ig,"")}}}aj=aj.replace(/<a(\s+[^>]+)?\/>/,"<a$1></a>");if(!A){function ag(ap,au,ak,an){var at="",am,ar,aq,ao;am=ak.match(/font-family\s*:\s*([^;"]+)/i);if(am){at+=' face="'+am[1]+'"'}ar=ak.match(/font-size\s*:\s*([^;"]+)/i);if(ar){ar=ar[1].toLowerCase();for(var al=0;al<t.length;al++){if(ar==t[al].n||ar==t[al].s){aq=al+1;break}}if(aq){at+=' size="'+aq+'"';ak=ak.replace(/(^|;)(\s*font-size\s*:\s*[^;"]+;?)+/ig,"$1")}}ao=ak.match(/color\s*:\s*([^;"]+)/i);if(ao){at+=' color="'+ao[1]+'"'}ak=ak.replace(/(^|;)(\s*(font-family|color)\s*:\s*[^;"]+;?)+/ig,"$1");if(at!=""){if(ak){at+=' style="'+ak+'"'}return"<font"+at+">"+an+"</font>"}else{return ap}}aj=aj.replace(/<(span)(?:\s+[^>]+)? style="((?:[^"]*?;)*\s*(?:font-family|font-size|color)\s*:[^"]*)"(?: [^>]+)?>(((?!<\1(\s+[^>]+)?>)[\s\S])*?)<\/\1>/ig,ag);aj=aj.replace(/<(span)(?:\s+[^>]+)? style="((?:[^"]*?;)*\s*(?:font-family|font-size|color)\s*:[^"]*)"(?: [^>]+)?>(((?!<\1(\s+[^>]+)?>)[\s\S]|<\1(\s+[^>]+)?>((?!<\1(\s+[^>]+)?>)[\s\S])*?<\/\1>)*?)<\/\1>/ig,ag);aj=aj.replace(/<(span)(?:\s+[^>]+)? style="((?:[^"]*?;)*\s*(?:font-family|font-size|color)\s*:[^"]*)"(?: [^>]+)?>(((?!<\1(\s+[^>]+)?>)[\s\S]|<\1(\s+[^>]+)?>((?!<\1(\s+[^>]+)?>)[\s\S]|<\1(\s+[^>]+)?>((?!<\1(\s+[^>]+)?>)[\s\S])*?<\/\1>)*?<\/\1>)*?)<\/\1>/ig,ag)}}else{if(A){aj=aj.replace(/("|;)\s*font-size\s*:\s*([a-z-]+);/ig,function(ao,ap,ak){var am,an;for(var al=0;al<t.length;al++){am=t[al];if(ak==am.wkn){an=am.n;break}}return ap+"font-size:"+an});var ah=[{r:/font-weight:\sbold/ig,t:"strong"},{r:/font-style:\sitalic/ig,t:"em"},{r:/text-decoration:\sunderline/ig,t:"u"},{r:/text-decoration:\sline-through/ig,t:"strike"}];function ae(aq,al,an,am,ar){var ak=an+am,ap="";for(var ao=0;ao<ah.length;ao++){if(ak.match(ah[ao].r)){ap=ah[ao].t;break}}if(ap){return"<"+ap+">"+ar+"</"+ap+">"}else{return aq}}aj=aj.replace(/<(span)(\s+[^>]+|)? class="Apple-style-span"(\s+[^>]+|)?>(((?!<\1(\s+[^>]+)?>)[\s\S])*?)<\/\1>/ig,ae);aj=aj.replace(/<(span)(\s+[^>]+|)? class="Apple-style-span"(\s+[^>]+|)?>(((?!<\1(\s+[^>]+)?>)[\s\S]|<\1(\s+[^>]+)?>((?!<\1(\s+[^>]+)?>)[\s\S])*?<\/\1>)*?)<\/\1>/ig,ae);aj=aj.replace(/<(span)(\s+[^>]+|)? class="Apple-style-span"(\s+[^>]+|)?>(((?!<\1(\s+[^>]+)?>)[\s\S]|<\1(\s+[^>]+)?>((?!<\1(\s+[^>]+)?>)[\s\S]|<\1(\s+[^>]+)?>((?!<\1(\s+[^>]+)?>)[\s\S])*?<\/\1>)*?<\/\1>)*?)<\/\1>/ig,ae)}aj=aj.replace(/\s*(?:-moz-|-webkit-)[^=:>]+?[=:]\s*(["']?)[^";>]*\1\s*;?/ig,"");aj=aj.replace(/<(\w+[^>]*?)\s+class="?(?:apple|webkit)\-[^ >]*([^>]*?)>/ig,"<$1$2>")}return aj};this.getSource=function(){var ae;if(K){ae=h("#sourceCode",G).val()}else{ae=W.processHTML(h(G.body).html(),"read");ae=W.cleanWord(ae);ae=W.cleanHTML(ae);ae=W.formatXHTML(ae);if(aa.beforeGetSource){ae=aa.beforeGetSource(ae)}}X.val(ae);return ae};this.cleanWord=function(ae){if(ae.match(/class="?mso/i)){ae=ae.replace(/<!--([\s\S]*?)-->|<style(\s+[^>]+)?>[\s\S]*?<\/style>/ig,"");ae=ae.replace(/<(meta|link)(\s+[^>]+)?>/ig,"");ae=ae.replace(/<\??xml(:\w+)?( [^>]+)?>([\s\S]*?<\/xml>)?/ig,"");ae=ae.replace(/<\/?\w+:[^>]*>/ig,"");ae=ae.replace(/<(\w+[^>]*?)\s+class="?mso[^ >]*([^>]*?)>/ig,"<$1$2>");ae=ae.replace(/<(\w+[^>]*?)\s+lang="?[^ \>]*([^>]*?)>/ig,"<$1$2>");ae=ae.replace(/<(\w+[^>]*?)\s+align="?left"?([^>]*?)>/ig,"<$1$2>");ae=ae.replace(/\s*mso-[^:]+:[^;"]+;?\s*/ig,"");ae=ae.replace(/\s*margin: 0cm 0cm 0pt\s*;\s*/ig,"");ae=ae.replace(/\s*margin: 0cm 0cm 0pt\s*"/ig,'"');ae=ae.replace(/\s*text-align:[^;"]+;?\s*/ig,"");ae=ae.replace(/\s*font-variant:[^;"]+;?\s*/ig,"");ae=ae.replace(/<(\w+[^>]*?) style="?"?( |>)/ig,"<$1$2")}return ae};this.cleanHTML=function(af){if(aa.clearScript){af=af.replace(/<(script)>(((?!<\1(\s+[^>]+)?>)[\s\S]|<\1(\s+[^>]+)?>((?!<\1(\s+[^>]+)?>)[\s\S]|<\1(\s+[^>]+)?>((?!<\1(\s+[^>]+)?>)[\s\S])*?<\/\1>)*?<\/\1>)*?)<\/\1>/ig,"")}if(aa.clearStyle){af=af.replace(/<(style)>(((?!<\1(\s+[^>]+)?>)[\s\S]|<\1(\s+[^>]+)?>((?!<\1(\s+[^>]+)?>)[\s\S]|<\1(\s+[^>]+)?>((?!<\1(\s+[^>]+)?>)[\s\S])*?<\/\1>)*?<\/\1>)*?)<\/\1>/ig,"")}for(var ae=0;ae<3;ae++){af=af.replace(/<(span|strong|b|u|strike|em|i)(\s+[^>]+)?>((?!<\1)[ \t\r\n])*?<\/\1>/ig,"")}af=af.replace(/<(span)>(((?!<\1(\s+[^>]+)?>)[\s\S])*?)<\/\1>/ig,"$2");af=af.replace(/<(span)>(((?!<\1(\s+[^>]+)?>)[\s\S]|<\1(\s+[^>]+)?>((?!<\1(\s+[^>]+)?>)[\s\S])*?<\/\1>)*?)<\/\1>/ig,"$2");af=af.replace(/<(span)>(((?!<\1(\s+[^>]+)?>)[\s\S]|<\1(\s+[^>]+)?>((?!<\1(\s+[^>]+)?>)[\s\S]|<\1(\s+[^>]+)?>((?!<\1(\s+[^>]+)?>)[\s\S])*?<\/\1>)*?<\/\1>)*?)<\/\1>/ig,"$2");af=af.replace(/<(p|div)(?:\s+[^>]+)?>(((?!<\1(?: [^>]+)?>)[\s\S])+?)<\/\1>/ig,function(ai,ag,aj){var ah=aj.replace(/<\/?(span|strong|b|u|strike|em|i)(\s+[^>]+)?>/ig,"");ah=ah.replace(/([ \t\r\n]|&nbsp;)+/ig,"");if(ah!=""){return ai}else{return"<"+ag+"></"+ag+">"}});af=af.replace(/^\s+/g,"");af=af.replace(/[\r\n]+/g,"\r\n");af=af.replace(/\s+$/g,"");return af};this.formatXHTML=function(ar){var am=ap("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed");var ag=ap("address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul");var ae=ap("a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var");var aA=ap("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr");var an=ap("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected");var az=ap("script,style");var af={b:"strong",i:"em",s:"strike"};var aw=/^<(\w+(?:\:\w+)?)((?:\s+[\w-(?:\:\w+)?]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/;var ak=/^<\/(\w+(?:\:\w+)?)[^>]*>/;var au=/([\w-(?:\:\w+)?]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g;var ai,aq,ah=[],al=ar,ao="",at=[];ah.last=function(){return this[this.length-1]};while(ar){aq=true;if(!ah.last()||!az[ah.last()]){if(ar.indexOf("<!")==0){match=ar.match(/^<!(?:--)?(.*?)(?:--)?>/);if(match){ar=ar.substring(match[0].length);at.push("<!--"+match[1]+"-->");aq=false}}else{if(ar.indexOf("</")==0){match=ar.match(ak);if(match){ar=ar.substring(match[0].length);match[0].replace(ak,ax);aq=false}}else{if(ar.indexOf("<")==0){match=ar.match(aw);if(match){ar=ar.substring(match[0].length);match[0].replace(aw,ay);aq=false}}}}if(aq){ai=ar.indexOf("<");ao=ai<0?ar:ar.substring(0,ai);ar=ai<0?"":ar.substring(ai);at.push(ao)}}else{ar=ar.replace(/^([\s\S]*?)<\/(?:style|script)>/i,function(aB,aC){at.push(aC);return""});ax("",ah.last())}if(ar==al){ax();return at.join("")}al=ar}ax();function ap(aE){var aD={},aB=aE.split(",");for(var aC=0;aC<aB.length;aC++){aD[aB[aC]]=true}return aD}function aj(aC){if(aC){aC=aC.toLowerCase();var aB=af[aC];if(aB){aC=aB}}else{aC=""}return aC}function ay(aB,aD,aE,aC){aD=aj(aD);if(ag[aD]){while(ah.last()&&ae[ah.last()]){ax("",ah.last())}}if(aA[aD]&&ah.last()==aD){ax("",aD)}aC=am[aD]||!!aC;if(!aC){ah.push(aD)}at.push("<"+aD);aE.replace(au,function(aG,aF){aF=aF.toLowerCase();var aH=arguments[2]?arguments[2]:arguments[3]?arguments[3]:arguments[4]?arguments[4]:an[aF]?aF:"";if(aH){at.push(" "+aF+'="'+aH.replace(/(^|[^\\])"/g,'$1\\"')+'"')}});at.push((aC?"/":"")+">")}function ax(aB,aD){if(!aD){var aE=0}else{aD=aj(aD);for(var aE=ah.length-1;aE>=0;aE--){if(ah[aE]==aD){break}}}if(aE>=0){for(var aC=ah.length-1;aC>=aE;aC--){at.push("</"+ah[aC]+">")}ah.length=aE}}ar=at.join("");function av(aF,aJ,aG,aD){var aH="",aC,aI,aE,aB;aC=aG.match(/ face\s*=\s*"\s*([^"]+)\s*"/i);if(aC){aH+="font-family:"+aC[1]+";"}aI=aG.match(/ size\s*=\s*"\s*(\d+)\s*"/i);if(aI){aH+="font-size:"+t[aI[1]-1].n+";"}aE=aG.match(/ color\s*=\s*"\s*([^"]+)\s*"/i);if(aE){aH+="color:"+aE[1]+";"}aB=aG.match(/ style\s*=\s*"\s*([^"]+)\s*"/i);if(aB){aH+=aB[1]}if(aH){aD='<span style="'+aH+'">'+aD+"</span>"}return aD}ar=ar.replace(/<(font)(\s+[^>]+|)?>(((?!<\1(\s+[^>]+)?>)[\s\S])*?)<\/\1>/ig,av);ar=ar.replace(/<(font)(\s+[^>]+|)?>(((?!<\1(\s+[^>]+)?>)[\s\S]|<\1(\s+[^>]+)?>((?!<\1(\s+[^>]+)?>)[\s\S])*?<\/\1>)*?)<\/\1>/ig,av);ar=ar.replace(/<(font)(\s+[^>]+|)?>(((?!<\1(\s+[^>]+)?>)[\s\S]|<\1(\s+[^>]+)?>((?!<\1(\s+[^>]+)?>)[\s\S]|<\1(\s+[^>]+)?>((?!<\1(\s+[^>]+)?>)[\s\S])*?<\/\1>)*?<\/\1>)*?)<\/\1>/ig,av);return ar};this.toggleSource=function(af){if(E||K===af){return}P.find("[name=Source]").toggleClass("xhEdtEnabled").toggleClass("xhEdtActive");P.find(".xhEdtButton").not("[name=Source],[name=Fullscreen],[name=About]").toggleClass("xhEdtEnabled");if(q){W.hidePanel()}var ae=h(G.body),ag=W.getSource();if(!K){if(p){G.body.contentEditable="false"}else{G.designMode="Off"}ae.attr("scroll","no").attr("class","sourceMode").html('<textarea id="sourceCode" wrap="soft" spellcheck="false" />');ae.find("#sourceCode").blur(W.getSource)}else{ae.find("#sourceCode").remove();if(p){G.body.contentEditable="true"}else{G.designMode="On"}ae.removeAttr("scroll").attr("class","editMode"+Y)}K=!K;W._setSource(ag);P.find("[name=Source]").toggleClass("xhEdtEnabled");setTimeout(W.setOpts,300)};this.togglePreview=function(af){if(K||E===af){return}P.find("[name=Preview]").toggleClass("xhEdtActive").toggleClass("xhEdtEnabled");P.find(".xhEdtButton").not("[name=Preview],[name=Fullscreen],[name=About]").toggleClass("xhEdtEnabled");var ae=h(G.body);if(!E){if(p){G.body.contentEditable="false"}else{G.designMode="Off"}ae.attr("class","previewMode");ae[0].innerHTML=ae.html()}else{if(p){G.body.contentEditable="true"}else{G.designMode="On"}ae.attr("class","editMode"+Y);ae[0].innerHTML=ae.html()}E=!E;P.find("[name=Preview]").toggleClass("xhEdtEnabled");setTimeout(W.setOpts,300)};this.toggleFullscreen=function(ag){if(ac===ag){return}if(q){W.hidePanel()}var af=h("#"+V).find(".xhEdtLayout"),ae=h("#"+V);if(ac){af.attr("style",T);h(".xhEdtIframeArea").height("100%")}else{T=af.attr("style");af.removeAttr("style");setTimeout(W.fixFullHeight,100)}ac=!ac;ae.toggleClass("xhEdt_Fullscreen");h("html").toggleClass("xhEdt_Fullfix");P.find("[name=Fullscreen]").toggleClass("xhEdtActive");setTimeout(W.setOpts,300)};this.addShortCut=function(ae,af){I[ae.toLowerCase()]=af};this.checkShortCut=function(ag){if(K||E){return true}ab=ag;var af=ab.which,ae=y[af],ah=ae?ae:String.fromCharCode(af).toLowerCase();sKey="";sKey+=ab.ctrlKey?"ctrl+":"";sKey+=ab.altKey?"alt+":"";sKey+=ab.shiftKey?"shift+":"";sKey+=ah;if(I[sKey]){W.exec(I[sKey]);return false}};this.showMenu=function(ag,ah){var af=h('<div class="xhEdtMenu"></div>'),ae;h.each(ag,function(aj,ai){ae=h('<a href="javascript:;" title="'+ai.t+'">'+ai.s+"</a>").click(function(){W.focus();ah(ai.v);W.hidePanel()}).mousedown(function(){return false});af.append(ae)});W.showPanel(af)};this.showColor=function(ai){var af=h('<div class="xhEdtColor"></div>'),ag,ae,ah=0;ag=h("<div></div>");h.each(l,function(ak,aj){ah++;ae=h('<a href="javascript:;" title="'+aj+'" style="background:'+aj+'"><img src="'+x+"xheditor_skin/"+aa.skin+'/img/spacer.gif" /></a>').click(function(){W.focus();ai(aj);W.hidePanel()}).mousedown(function(){return false});ag.append(ae);if(ah%10==0){af.append(ag);ag=h("<div></div>")}});af.append(ag);W.showPanel(af)};this.showPastetext=function(){var af=h('<div class="xhEdtDialog"></div>');af.append(a);var ag=h("#xhEdtPastetextValue",af),ae=h("#xhEdtSave",af);ae.click(function(){W.focus();var ah=ag.val();if(ah){W.pasteText(ah)}W.hidePanel();return false});W.showPanel(af)};this.showLink=function(){var af=h('<div class="xhEdtDialog"></div>');af.append(b);var ag=W.getParent("a"),ai=h("#xhEdtLinkHref",af),ah=h("#xhEdtLinkTarget",af),ae=h("#xhEdtSave",af);if(ag.size()==1){ai.val(ag.attr("href"));ah.attr("value",ag.attr("target"))}ae.click(function(){W.focus();var aj=ai.val();if(aj==""||ag.size()==0){W._exec("unlink")}if(aj!=""){if(ag.size()==0){W._exec("createlink","#xhedt_tempurl");ag=h('a[href$="#xhedt_tempurl"]',G)}ag.attr("href",aj);if(ah.val()!=""){ag.attr("target",ah.val())}else{ag.removeAttr("target")}}W.hidePanel();return false});W.showPanel(af)};this.showImg=function(){var am=h('<div class="xhEdtDialog"></div>');am.append(v);var ag=W.getParent("img"),ah=h("#xhEdtImgSrc",am),an=h("#xhEdtImgAlt",am),ap=h("#xhEdtImgAlign",am),ai=h("#xhEdtImgWidth",am),aj=h("#xhEdtImgHeight",am),ao=h("#xhEdtImgBorder",am),ae=h("#xhEdtImgVspace",am),ak=h("#xhEdtImgHspace",am),al=h("#xhEdtSave",am);if(ag.size()==1){ah.val(ag.attr("src"));an.val(ag.attr("alt"));ap.val(ag.attr("align"));ai.val(ag.attr("width"));aj.val(ag.attr("height"));ao.val(ag.attr("border"));var af=ag.attr("vspace"),aq=ag.attr("hspace");ae.val(af<0?0:af);ak.val(aq<0?0:aq)}al.click(function(){W.focus();var ar=ah.val();if(ar!=""){if(ag.size()==0){W._exec("insertimage","#xhedt_tempurl");ag=h('img[src$="#xhedt_tempurl"]',G)}ag.attr("src",ar);if(an.val()!=""){ag.attr("alt",an.val())}else{ag.removeAttr("alt")}if(ap.val()!=""){ag.attr("align",ap.val())}else{ag.removeAttr("align")}if(ai.val()!=""){ag.attr("width",ai.val())}else{ag.removeAttr("width")}if(aj.val()!=""){ag.attr("height",aj.val())}else{ag.removeAttr("height")}if(ao.val()!=""){ag.attr("border",ao.val())}else{ag.removeAttr("border")}if(ae.val()!=""){ag.attr("vspace",ae.val())}else{ag.removeAttr("vspace")}if(ak.val()!=""){ag.attr("hspace",ak.val())}else{ag.removeAttr("hspace")}}else{if(ag.size()==1){ag.remove()}}W.hidePanel();return false});W.showPanel(am)};this.showFlash=function(){var ag=h('<div class="xhEdtDialog"></div>');ag.append(C);var ah=W.getParent('embed[type="application/x-shockwave-flash"]'),aj=h("#xhEdtFlashSrc",ag),ai=h("#xhEdtFlashWidth",ag),ae=h("#xhEdtFlashHeight",ag),af=h("#xhEdtSave",ag);if(ah.size()==1){aj.val(ah.attr("src"));ai.val(ah.attr("width"));ae.val(ah.attr("height"))}af.click(function(){W.focus();var al=aj.val();if(al!=""){if(ah.size()==0){W.pasteHTML('<embed type="application/x-shockwave-flash" src="#xhedt_tempurl" wmode="opaque" quality="high" bgcolor="#ffffff" menu="false" play="true" loop="true" />');ah=h('embed[src$="#xhedt_tempurl"]',G)}ah.attr("src",al);var ak=ai.val(),an=ae.val(),am=/^[0-9]+$/;if(!am.test(ak)){ak=412}if(!am.test(an)){an=300}ah.attr("width",ak);ah.attr("height",an)}else{if(ah.size()==1){ah.remove()}}W.hidePanel();return false});W.showPanel(ag)};this.showMeida=function(){var aj=h('<div class="xhEdtDialog"></div>');aj.append(u);var ag=W.getParent('embed[type="application/x-mplayer2"]'),ai=h("#xhEdtMediaSrc",aj),ah=h("#xhEdtMediaWidth",aj),ae=h("#xhEdtMediaHeight",aj),af=h("#xhEdtSave",aj);if(ag.size()==1){ai.val(ag.attr("src"));ah.val(ag.attr("width"));ae.val(ag.attr("height"))}af.click(function(){W.focus();var al=ai.val();if(al!=""){if(ag.size()==0){W.pasteHTML('<embed type="application/x-mplayer2" src="#xhedt_tempurl" enablecontextmenu="false" autostart="false" />');ag=h('embed[src$="#xhedt_tempurl"]',G)}ag.attr("src",al);var ak=ah.val(),an=ae.val(),am=/^[0-9]+$/;if(!am.test(ak)){ak=412}if(!am.test(an)){an=300}ag.attr("width",ak);ag.attr("height",an)}else{if(ag.size()==1){ag.remove()}}W.hidePanel();return false});W.showPanel(aj)};this.showEmot=function(){var ai=h('<div class="xhEdtEmot"></div>'),ag,ae,ah=0,af=x+"xheditor_emot/";ag=h("<div></div>");h.each(m,function(ak,aj){ah++;ae=h('<a href="javascript:;" title="'+aj.t+'"><img src="'+af+aj.s+'" /></a>').click(function(){W.focus();W._exec("insertimage",af+aj.s);W.hidePanel()}).mousedown(function(){return false});ag.append(ae);if(ah%6==0){ai.append(ag);ag=h("<div></div>")}});ai.append(ag);W.showPanel(ai)};this.showTable=function(){var af=h('<div class="xhEdtDialog"></div>');af.append(g);var ae=h("#xhEdtTableRows",af),ap=h("#xhEdtTableColumns",af),am=h("#xhEdtTableHeaders",af),ah=h("#xhEdtTableWidth",af),ai=h("#xhEdtTableHeight",af),ao=h("#xhEdtTableBorder",af),ag=h("#xhEdtTableCellSpacing",af),ak=h("#xhEdtTableCellPadding",af),an=h("#xhEdtTableAlign",af),aj=h("#xhEdtTableCaption",af),al=h("#xhEdtSave",af);al.click(function(){W.focus();var aD=aj.val(),aC=ao.val(),av=ae.val(),aq=ap.val(),at=am.val(),ar=ah.val(),az=ai.val(),ax=ag.val(),aA=ak.val(),aB=an.val();var ay,aw,au="<table"+(aC!=""?' border="'+aC+'"':"")+(ar!=""?' width="'+ar+'"':"")+(az!=""?' width="'+az+'"':"")+(ax!=""?' cellspacing="'+ax+'"':"")+(aA!=""?' cellpadding="'+aA+'"':"")+(aB!=""?' align="'+aB+'"':"")+">";if(aD!=""){au+="<caption>"+aD+"</caption>"}if(at=="row"||at=="both"){au+="<tr>";for(ay=0;ay<aq;ay++){au+='<th scope="col">&nbsp;</th>'}au+="</tr>";av--}au+="<tbody>";for(ay=0;ay<av;ay++){au+="<tr>";for(aw=0;aw<aq;aw++){if(aw==0&&(at=="col"||at=="both")){au+='<th scope="row">&nbsp;</th>'}else{au+="<td>&nbsp;</td>"}}au+="</tr>"}au+="</tbody></table>";W.pasteHTML(au);W.hidePanel();return false});W.showPanel(af)};this.showAbout=function(){var af=h('<div class="xhEdtDialog"></div>');af.append(o);var ae=h("#xhEdtSave",af);ae.click(function(){W.focus();W.hidePanel();return false});W.showPanel(af)};this.showPanel=function(af){if(q){W.hidePanel()}d.empty().append(af);i=h(ab.target).closest("a");var ag=i.offset();var ae=ag.left,ah=ag.top;ah+=i.height();i.addClass("xhEdtActive");n.css("left",ae+1).css("top",ah).show();d.css("left",ae).css("top",ah).show();q=true};this.hidePanel=function(){if(q){i.removeClass("xhEdtActive");n.hide();d.hide();q=false}};this.exec=function(ah){ah=ah.toLowerCase();switch(ah){case"cut":try{G.execCommand(ah);if(!G.queryCommandSupported(ah)){throw"Error"}}catch(ag){alert("您的浏览器安全设置不允许使用剪切操作，请使用键盘快捷键(Ctrl + X)来完成")}break;case"copy":try{G.execCommand(ah);if(!G.queryCommandSupported(ah)){throw"Error"}}catch(ag){alert("您的浏览器安全设置不允许使用复制操作，请使用键盘快捷键(Ctrl + C)来完成")}break;case"paste":try{G.execCommand(ah);if(!G.queryCommandSupported(ah)){throw"Error"}}catch(ag){alert("您的浏览器安全设置不允许使用粘贴操作，请使用键盘快捷键(Ctrl + V)来完成")}break;case"pastetext":if(window.clipboardData){W.pasteText(window.clipboardData.getData("Text",true))}else{W.showPastetext()}break;case"blocktag":var ai=[];h.each(w,function(ak,aj){ai.push({s:"<"+aj.n+">"+aj.t+"</"+aj.n+">",v:"<"+aj.n+">",t:aj.t})});W.showMenu(ai,function(aj){W._exec("formatblock",aj)});break;case"fontface":var ae=[];h.each(c,function(ak,aj){ae.push({s:'<span style="font-family:'+aj+'">'+aj+"</span>",v:aj,t:aj})});W.showMenu(ae,function(aj){W._exec("fontname",aj)});break;case"fontsize":var af=[];h.each(t,function(ak,aj){af.push({s:'<span style="font-size:'+aj.s+'">'+aj.t+"("+aj.s+")</span>",v:ak+1,t:aj.t})});W.showMenu(af,function(aj){W._exec("fontsize",aj)});break;case"fontcolor":W.showColor(function(aj){W._exec("forecolor",aj)});break;case"backcolor":W.showColor(function(aj){if(p){W._exec("backcolor",aj)}else{W.setCSS(true);W._exec("hilitecolor",aj);W.setCSS(false)}});break;case"align":W.showMenu(e,function(aj){W._exec(aj)});break;case"list":W.showMenu(f,function(aj){W._exec(aj)});break;case"link":W.showLink();break;case"img":W.showImg();break;case"flash":W.showFlash();break;case"media":W.showMeida();break;case"emot":W.showEmot();break;case"table":W.showTable();break;case"source":W.toggleSource();break;case"preview":W.togglePreview();break;case"fullscreen":W.toggleFullscreen();break;case"about":W.showAbout();break;default:W._exec(ah);break}};this._exec=function(ae,af){if(af!=undefined){return G.execCommand(ae,false,af)}else{return G.execCommand(ae,false,null)}}};h(function(){h("textarea.xheditor").xheditor(true);h("textarea.xheditor-mini").xheditor(true,{tools:"mini"});h("textarea.xheditor-simple").xheditor(true,{tools:"simple"})})})(jQuery);